<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SwaggyP36000 IPA Library</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }

        header {
            background-color: #4285f4; /* Google Blue */
            color: #fff;
            text-align: center;
            padding: 1em 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #app-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            padding: 20px;
        }

        .app-card {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin: 10px;
            padding: 20px;
            width: 300px;
            transition: transform 0.3s;
            cursor: pointer;
        }

        .app-card:hover {
            transform: scale(1.05);
        }

        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 15px;
            max-height: 100px; /* Fixed icon height */
        }

        h2 {
            color: #333;
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        p {
            color: #666;
            margin-bottom: 5px;
        }

        .bundle-id {
            color: #777;
            margin-bottom: 5px;
        }

        .version-card {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin: 10px;
            padding: 20px;
            width: 300px;
            transition: transform 0.3s;
        }

        .version-card:hover {
            transform: scale(1.05);
        }

        .download-link {
            display: block;
            margin-top: 10px;
            text-decoration: none;
            color: #4285f4; /* Google Blue */
        }

        .search-container {
            text-align: center;
            margin: 20px 0;
        }

        #search-bar {
            padding: 10px;
            width: 60%;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .description {
            margin-top: 15px;
        }

        .status {
            margin-top: 10px;
            font-weight: bold;
        }

        .status i {
            margin-right: 5px; /* Adjust the spacing between icon and text */
        }

        .details-btn {
            background-color: #4285f4;
            color: #fff;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        .details-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .details-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            width: 60%;
            text-align: left;
        }

        .close-btn {
            background-color: #4285f4;
            color: #fff;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>

<body>

    <header>
        <h1>SwaggyP36000 IPA Library</h1>
    </header>

    <div class="search-container">
        <input type="text" id="search-bar" placeholder="Search for apps..." oninput="filterApps()">
    </div>

    <div id="app-container"></div>

    <div class="details-modal" id="detailsModal">
        <div class="details-content">
            <span class="close-btn" onclick="closeDetailsModal()">&times;</span>
            <h2 id="detailsTitle"></h2>
            <p id="detailsDescription"></p>
            <p id="detailsStatus"></p>
        </div>
    </div>
 <script>
    // Replace the placeholder link with the actual link from where to fetch the app information
    const appLink = 'https://raw.githubusercontent.com/swaggyP36000/TrollStore-IPAs/main/apps.json';
        const readmeLink = 'https://raw.githubusercontent.com/swaggyP36000/TrollStore-IPAs/main/README.md';

        let originalApps = [];
        let descriptions = {};

        fetch(appLink)
            .then(response => response.json())
            .then(apps => {
                originalApps = apps.apps;
                fetchReadme();
            });

        function fetchReadme() {
            fetch(readmeLink)
                .then(response => response.text())
                .then(text => parseReadme(text))
                .catch(error => console.error('Error fetching README:', error));
        }

        function parseReadme(text) {
            const regex = /\| (\S+) \| ([^|]+) \| ([^|]+) \| ([^|]+) \| ([^|]+) \| ([^|]+) \|/g;
            let match;

            while ((match = regex.exec(text)) !== null) {
                const appNameFromReadme = match[1].trim();
                const description = match[2].trim();
                const statusText = match[6].trim();

                // Find the matching app from the JSON data by comparing names after removing spaces and converting to lowercase
                const matchedApp = originalApps.find(app => cleanAndNormalizeName(app.name) === cleanAndNormalizeName(appNameFromReadme));

                if (matchedApp) {
                    descriptions[matchedApp.name] = { description, statusText };
                }
            }

            displayApps(originalApps);
        }

        function cleanAndNormalizeName(name) {
            return name.replace(/\s/g, '').toLowerCase();
        }

    function getStatusEmoji(statusText) {
        const emojiMap = {
            ':white_check_mark:': 'âœ…',
            ':x:': 'âŒ',
            ':warning:': 'âš ï¸',
            ':no_entry_sign:': 'ðŸš«',
            ':thumbsup:': 'ðŸ‘',
            ':bulb:': 'ðŸ’¡',
            ':grey_question:': 'â”',
        };

        const emojiCodes = statusText.match(/:[^:\s]+:/g) || [];
        return emojiCodes.map(code => emojiMap[code] || code).join(' ');
    }

    function displayApps(apps) {
        const appContainer = document.getElementById('app-container');
        appContainer.innerHTML = '';

        // Group apps by app name
        const groupedApps = groupAppsByAppName(apps);

        // Display a card for each app name
        groupedApps.forEach(group => {
            const appCard = document.createElement('div');
            appCard.classList.add('app-card');

            const img = document.createElement('img');
            img.src = group[0].iconURL;
            img.alt = group[0].name;

            const appName = document.createElement('h2');
            appName.textContent = group[0].name;

            const appBundleId = document.createElement('p');
            appBundleId.textContent = `Bundle ID: ${group[0].bundleIdentifier}`;
            appBundleId.classList.add('bundle-id');

            const appVersion = document.createElement('p');
            appVersion.textContent = `Latest Version: ${group[0].version}`;

            const appVersionDate = document.createElement('p');
            appVersionDate.textContent = `Updated: ${group[0].versionDate}`;

            const appSize = document.createElement('p');
            const sizeInMB = (group[0].size / (1024 * 1024)).toFixed(2);
            appSize.textContent = `Size: ${sizeInMB} MB`;

            const downloadLink = document.createElement('a');
            downloadLink.href = group[0].downloadURL;
            downloadLink.textContent = 'Download';
            downloadLink.classList.add('download-link');

            const detailsBtn = document.createElement('button');
            detailsBtn.textContent = 'Show Details';
            detailsBtn.classList.add('details-btn');
            detailsBtn.onclick = () => showDetailsModal(group[0].name);

            appCard.appendChild(img);
            appCard.appendChild(appName);
            appCard.appendChild(appBundleId);
            appCard.appendChild(appVersion);
            appCard.appendChild(appVersionDate);
            appCard.appendChild(appSize);
            appCard.appendChild(downloadLink);
            appCard.appendChild(detailsBtn);

            appContainer.appendChild(appCard);
        });
    }

    function groupAppsByAppName(apps) {
        const groupedApps = {};
        apps.forEach(app => {
            if (!groupedApps[app.name]) {
                groupedApps[app.name] = [];
            }
            groupedApps[app.name].push(app);
        });
        return Object.values(groupedApps);
    }

    function showDetailsModal(appName) {
        const modal = document.getElementById('detailsModal');
        const title = document.getElementById('detailsTitle');
        const description = document.getElementById('detailsDescription');
        const status = document.getElementById('detailsStatus');

        title.textContent = appName;
        description.textContent = descriptions[appName] ? descriptions[appName].description : '';
        status.textContent = descriptions[appName] ? `Status: ${getStatusEmoji(descriptions[appName].statusText)}` : '';

        modal.style.display = 'flex';
    }

    function closeDetailsModal() {
        const modal = document.getElementById('detailsModal');
        modal.style.display = 'none';
    }

    function filterApps() {
        const searchInput = document.getElementById('search-bar').value.toLowerCase();
        const filteredApps = originalApps.filter(app => app.name.toLowerCase().includes(searchInput));

        displayApps(filteredApps);
    }
</script>

    
</body>
</html>
